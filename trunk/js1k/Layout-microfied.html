<!DOCTYPE HTML>
<html>
	<head>
		<title>JS1k Demo - 1016 bytes minified</title>
		<meta charset="utf-8"/>
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
        eval("F=.95;D=40;K=2e-5;T=255;N=[0];M=[0];n=I=0;A=Math.abs;P=2*Math.PI;C=document.body.children[0];C.width=C.height=W=H=X=Y=600;onkeydown=@{N[i=++n]={x:X,y:Y,v:0,w:0,m:1};for(j=n;k=N[j];j--)if(!k.m&&!M[j]){N[++n]={x:(X-k.x)/2,y:(Y-k.y)/2,v:0,w:0,m:1};M[n]=[i,j]}};C.onmousedown=@{I=G.getImageData(X,Y,1,1).data[2];if(k=N[I=M[I]?0:I]){k.m=!k.m;k.v=k.w=0}};C.onmousemove=@{X=e.clientX;Y=e.clientY;if(k=N[I]){k.x=X;k.y=Y;k.m=0}};C.onmouseup=@{I=0};G=C.getContext('2d');setInterval(@{with(G){clearRect(0,0,W,H);strokeRect(0,0,W,H);for(i=n;k=N[i];i--)with(k){if(m&&i!=I){for(j=n;o=N[j];j--)if((t=A(x-o.x)+A(y-o.y))<2*D&&i!=j){t=t?t*t:1;v+=(x-o.x)/t;w+=(y-o.y)/t}if(M[i])for(j=0;o=N[M[i][j]];j++){t=A(x-o.x)+A(y-o.y);v-=r=K*(x-o.x)*t;w-=s=K*(y-o.y)*t;o.v+=r;o.w+=s}x+=v*=F;y+=w*=F;x=x>W?W:x<0?0:x;y=y>H?H:y<0?0:y;}beginPath();if(M[i]){o=N[M[i][0]];p=N[M[i][1]];moveTo(o.x,o.y);quadraticCurveTo(x,y,p.x,p.y)}else{arc(x,y,D/3,0,P,0);fillStyle='rgb('+!m*T+','+m*T+','+i+')';fill()}stroke()}}},1)".replace(/@/g,'function(e)'))
        </script>
        <br/>
        Hover over the canvas and press any key to add a node.
        <br/>
        Click to select/fixate a node.
        <br/>
        Click again to unselect/release a node.
        <br/>
        Selected nodes will be connected to the added node.
	</body>
</html>