<!DOCTYPE HTML>
<html>
	<head>
		<title>JS1k Demo</title>
		<meta charset="utf-8"/>
	</head>
	<body>
        <canvas id="c"></canvas><br/>
        Find the dot without a tail!
		<script>
        window.onload=function(){
            N=50;
            A=Math.abs;
            R=Math.random;
            C=document.body.children[0];
            C.width=W=innerWidth-24;
            C.height=H=innerHeight-42;
            G=C.getContext('2d');
            M=[];
            for(i=N;i;)
                M[--i]={x:W*R(),y:H*R(),v:0,w:0};
            setInterval(function(){
                with(G){
                    clearRect(0,0,W,H);
                    strokeRect(0,0,W,H);
                    for(i=0;n=M[i++];){
                        with(n){
                        for(j=0;k=M[j++];)
                            if((t=A(x-k.x)+A(y-k.y))<(W+H)/10&&i!=j){
                                t*=t;
                                v+=(x-k.x)/t;
                                w+=(y-k.y)/t;
                            }
                        x+=x>W||x<0?v*=-1:v;
                        y+=y>H||y<0?w*=-1:w;
                        fillRect(x-5,y-5,10,10)
                        }
                    }
                }
            },10);
        }
        </script>
	</body>
</html>